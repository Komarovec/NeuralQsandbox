#:kivy 1.0
<PopupColor>:
    title: 'Pick a Color'
    size_hint: 1.0, 0.6
    id: popupcolor

    BoxLayout:
        orientation: 'vertical'

        ColorPicker:
            id: colorpicker
            size_hint: 1.0, 1.0

        Button:
            text: 'PICK AND CLOSE'
            color: 0.435, 0.725, 0.56, 1
            background_color: 0, 0.26, 0.27, 1
            size_hint: 1.0, 0.2
            on_press: popupcolor.on_press_dismiss(colorpicker)

<Separator>:
    size_hint_y: None
    thickness: 4
    margin: 4
    height: self.thickness + 2 * self.margin
    color: .8, .8, .8
    canvas:
        Color:
            rgb: self.color
        Rectangle:
            pos: self.x + self.margin, self.y + self.margin + 1
            size: self.width - 2 * self.margin , self.thickness


<ObjectMenu>:
    id: objectMenu
    Widget:
        size: root.scaleFactor,root.scaleFactor*2
        pos: (root.width-self.width,(root.height-self.height)-48)
        canvas:
            Color:
                rgba: .1, .1, .1, 1
            Rectangle:
                size: self.size[0]+4,self.size[1]+4
                pos: self.pos[0]-4,self.pos[1]-4

            Color:
                rgba: .142, .142, .142, 1
            Rectangle:
                size: self.size
                pos: self.pos
                #radius: [(root.width+root.height)/ root.scaleFactor,]

        GridLayout:
            id: inObjectMenu
            rows: 4
            spacing: 2
            #padding: 0,50,0,50
            size: self.parent.size
            pos: self.parent.pos


<StateBar>:
    id: statebar

    canvas:
        Color:
            rgba: .1, .1, .1, 1
        Rectangle:
            pos: 0,0
            size: root.width, root.scaleFactor/5

    GridLayout:
        pos: 0,0
        size: root.width, root.scaleFactor/5
        cols: 3

        Label:
            id: steps
            text: "Steps: 0"
            font_size: root.scaleFactor/12.5

        Label:
            id: tool
            text: "Game state"
            font_size: root.scaleFactor/12.5

        Label:
            id: idk
            text: ""
            font_size: root.scaleFactor/12.5

<ToolBarEditor>:
    #Editor action bar
    BoxLayout:
        orientation: "horizontal"
        size: root.width, root.height

        ActionBar:
            id: mainActionBarGame
            pos_hint: {"top": 1}

            ActionView:
                use_separator: True
                ActionPrevious:
                    important: True
                    text: 'Game menu'
                    font_size: root.scaleFactor/12.5
                    on_press: 
                        root.screen.endLevelEditor()
                ActionOverflow:

                #Change the view
                ActionGroup:
                    mode: 'spinner'
                    text: 'View'
                    font_size: root.scaleFactor/12.5
                    ActionButton:
                        text: 'Center Camera'
                        minimum_width: root.scaleFactor*0.8
                        font_size: root.scaleFactor/12.5
                        on_press:
                            root.game.changeCamera("center")

                #Obect menu
                ActionButton:
                    text: 'Objects'
                    font_size: root.scaleFactor/12.5
                    on_press:
                        root.screen.toggleObjectMenu()

                #Tools
                ActionGroup:
                    mode: 'spinner'
                    text: 'Tools'
                    font_size: root.scaleFactor/12.5
                    ActionButton:
                        text: 'Delete'
                        font_size: root.scaleFactor/12.5
                        on_press:
                            root.game.changeTool("delete")


<ToolBarGame>:
    #Game action bar
    BoxLayout:
        orientation: "horizontal"
        size: root.width, root.height

        ActionBar:
            id: mainActionBarGame
            pos_hint: {"top": 1}

            ActionView:
                use_separator: True
                ActionPrevious:
                    important: True
                    text: 'Mainmenu'
                    font_size: root.scaleFactor/12.5
                    on_press: 
                        root.manager.transition.direction = 'right'
                        root.manager.current = 'mainmenu'
                ActionOverflow:

                ActionGroup:
                    mode: 'spinner'
                    text: 'View'
                    font_size: root.scaleFactor/12.5
                    ActionButton:
                        text: 'Center Camera'
                        minimum_width: root.scaleFactor*0.8
                        font_size: root.scaleFactor/12.5
                        on_press:
                            root.game.changeCamera("center")

                #File interaction buttons
                ActionGroup:
                    mode: 'spinner'
                    text: 'File'
                    font_size: root.scaleFactor/12.5
                    ActionButton:
                        text: 'Save File'
                        font_size: root.scaleFactor/12.5
                        on_press:
                            root.game.exportFile()
                    ActionButton:
                        text: 'Load File'
                        font_size: root.scaleFactor/12.5
                        on_press:
                            root.game.importFile()

                ActionButton:
                    text: 'Reset'
                    font_size: root.scaleFactor/12.5
                    on_press: 
                        root.game.reset()
                ActionButton:
                    text: 'Level Editor'
                    font_size: root.scaleFactor/12.5
                    on_press:
                        root.screen.startLevelEditor()