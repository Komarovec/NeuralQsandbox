#:kivy 1.0
<PopupColor>:
    title: 'Pick a Color'
    size_hint: 1.0, 0.6
    id: popupcolor

    BoxLayout:
        orientation: 'vertical'

        ColorPicker:
            id: colorpicker
            size_hint: 1.0, 1.0

        Button:
            text: 'PICK AND CLOSE'
            color: 0.435, 0.725, 0.56, 1
            background_color: 0, 0.26, 0.27, 1
            size_hint: 1.0, 0.2
            on_press: popupcolor.on_press_dismiss(colorpicker)

<Separator>:
    size_hint_y: None
    thickness: 4
    margin: 4
    height: self.thickness + 2 * self.margin
    color: .8, .8, .8
    canvas:
        Color:
            rgb: self.color
        Rectangle:
            pos: self.x + self.margin, self.y + self.margin + 1
            size: self.width - 2 * self.margin , self.thickness


<ObjectMenu>:
    id: objectMenu
    Widget:
        size: (root.width/(root.scaleFactor/35),root.height*0.5)
        pos: (root.width-self.width,(root.height-self.height)/2)
        canvas:
            Color:
                rgba: .1, .1, .1, 1
            RoundedRectangle:
                size: self.size
                pos: self.pos
                radius: [(root.width+root.height)/ root.scaleFactor,]

        GridLayout:
            id: inObjectMenu
            rows: 4
            spacing: 2
            #padding: 0,50,0,50
            size: self.parent.size
            pos: self.parent.pos


<StateBar>:
    id: statebar
    canvas:
        Color:
            rgba: .1, .1, .1, 1
        Rectangle:
            size: (root.width,root.height/(root.scaleFactor/10))
            pos: (0,0)

    GridLayout:
        size: (root.width,root.height/(root.scaleFactor/10))
        pos: (0,0)
        cols: 3

        Label:
            id: steps
            text: "Steps: 0"
            font_size: (root.width + root.height) / root.scaleFactor

        Label:
            id: tool
            text: "Game state"
            font_size: (root.width + root.height) / root.scaleFactor

        Label:
            id: idk
            text: ""
            font_size: (root.width + root.height) / root.scaleFactor

<ToolBarEditor>:
    #Level editor action bar
    ActionBar:
        id: levelEditActionBar
        size: (root.width, root.height/(root.scaleFactor/10))
        pos: (0,root.height-self.height)

        ActionView:
            use_separator: True
            ActionPrevious:
                important: True
                text: 'Game menu'
                font_size: (root.width + root.height) / root.scaleFactor
                on_press: 
                    root.screen.endLevelEditor()
            ActionOverflow:
            
            #Obect menu
            ActionButton:
                text: 'Objects'
                font_size: (root.width + root.height) / root.scaleFactor
                on_press:
                    root.screen.toggleObjectMenu()

            #File interaction buttons
            ActionGroup:
                mode: 'spinner'
                text: 'File'
                font_size: (root.width + root.height) / root.scaleFactor
                ActionButton:
                    text: 'Save File'
                    font_size: (root.width + root.height) / root.scaleFactor
                    on_press:
                        root.game.exportFile()
                ActionButton:
                    text: 'Load File'
                    font_size: (root.width + root.height) / root.scaleFactor
                    on_press:
                        root.game.importFile()

            #Tools
            ActionGroup:
                mode: 'spinner'
                text: 'Tools'
                font_size: (root.width + root.height) / root.scaleFactor
                ActionButton:
                    text: 'Delete'
                    font_size: (root.width + root.height) / root.scaleFactor
                    on_press:
                        root.game.changeTool("delete")


<ToolBarGame>:
    #Game action bar
    ActionBar:
        id: mainActionBarGame
        size: (root.width, root.height/(root.scaleFactor/10))
        pos: (0,root.height-self.height)

        ActionView:
            use_separator: True
            ActionPrevious:
                important: True
                text: 'Mainmenu'
                font_size: (root.width + root.height) / root.scaleFactor
                on_press: 
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'mainmenu'
            ActionOverflow:
            ActionButton:
                text: 'Reset'
                font_size: (root.width + root.height) / root.scaleFactor
                on_press: 
                    root.game.reset()
            ActionButton:
                text: 'Level Editor'
                font_size: (root.width + root.height) / root.scaleFactor
                on_press:
                    root.screen.startLevelEditor()